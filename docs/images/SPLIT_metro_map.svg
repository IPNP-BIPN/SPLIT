<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 920" font-family="Segoe UI, Roboto, Helvetica, Arial, sans-serif">
  <rect width="800" height="920" fill="#ffffff" rx="12"/>
  <text x="400" y="38" text-anchor="middle" font-size="26" font-weight="800" fill="#1a1a2e" letter-spacing="3">SPLIT</text>
  <text x="400" y="56" text-anchor="middle" font-size="10" fill="#6b7280" letter-spacing="1.5">SNP-Level Inspection of Parental Transcripts</text>

  <!-- LEFT: Sample input (blue) -->
  <line x1="200" y1="90" x2="200" y2="280" stroke="#3b82f6" stroke-width="4" stroke-linecap="round"/>
  <rect x="130" y="78" width="140" height="24" rx="12" fill="#3b82f6"/>
  <text x="200" y="94" text-anchor="middle" font-size="10" font-weight="700" fill="#ffffff">SRA / GEO / FASTQ</text>
  <circle cx="200" cy="140" r="7" fill="#ffffff" stroke="#3b82f6" stroke-width="3"/>
  <text x="220" y="144" font-size="11" font-weight="600" fill="#1e3a5f">RESOLVE_GEO</text>
  <circle cx="200" cy="200" r="7" fill="#ffffff" stroke="#3b82f6" stroke-width="3"/>
  <text x="220" y="204" font-size="11" font-weight="600" fill="#1e3a5f">SRA_DOWNLOAD</text>
  <text x="220" y="218" font-size="9" fill="#9ca3af">fasterq-dump + pigz</text>
  <rect x="165" y="258" width="70" height="18" rx="9" fill="#dbeafe"/>
  <text x="200" y="271" text-anchor="middle" font-size="9" font-weight="600" fill="#3b82f6">FASTQs</text>

  <!-- RIGHT: References (violet) -->
  <line x1="530" y1="90" x2="530" y2="260" stroke="#8b5cf6" stroke-width="4" stroke-linecap="round"/>
  <rect x="440" y="78" width="180" height="24" rx="12" fill="#8b5cf6"/>
  <text x="530" y="94" text-anchor="middle" font-size="10" font-weight="700" fill="#ffffff">DOWNLOAD_REFERENCES</text>
  <circle cx="530" cy="140" r="7" fill="#ffffff" stroke="#8b5cf6" stroke-width="3"/>
  <text x="550" y="144" font-size="11" font-weight="600" fill="#4c1d95">FASTA + GTF + VCF</text>
  <text x="550" y="158" font-size="9" fill="#9ca3af">GRCm39 / Ensembl / MGP</text>
  <circle cx="530" cy="220" r="7" fill="#ffffff" stroke="#8b5cf6" stroke-width="3"/>
  <text x="550" y="224" font-size="11" font-weight="600" fill="#4c1d95">SNPSPLIT_GENOME_PREP</text>
  <text x="550" y="238" font-size="9" fill="#9ca3af">dual-hybrid N-masking</text>
  <rect x="468" y="258" width="52" height="16" rx="8" fill="#ede9fe"/>
  <text x="494" y="270" text-anchor="middle" font-size="8" font-weight="600" fill="#7c3aed">N-mask</text>
  <rect x="528" y="258" width="50" height="16" rx="8" fill="#fce7f3"/>
  <text x="553" y="270" text-anchor="middle" font-size="8" font-weight="600" fill="#db2777">SNP file</text>

  <!-- ESTIMATE READ LENGTH (gray) -->
  <line x1="200" y1="280" x2="200" y2="360" stroke="#6b7280" stroke-width="2.5" stroke-linecap="round"/>
  <circle cx="200" cy="320" r="6" fill="#ffffff" stroke="#6b7280" stroke-width="2.5"/>
  <text x="220" y="324" font-size="10" fill="#6b7280">ESTIMATE_READ_LENGTH</text>
  <text x="220" y="338" font-size="9" fill="#d1d5db">sjdbOverhang</text>

  <!-- Fork dot -->
  <circle cx="200" cy="360" r="4" fill="#6b7280"/>

  <!-- ORANGE TRACK (N-mask) x=200 -->
  <line x1="200" y1="360" x2="200" y2="700" stroke="#f97316" stroke-width="4" stroke-linecap="round"/>

  <!-- N-masked FASTA to STAR Index N-mask (dashed violet) -->
  <path d="M494,274 C480,320 320,370 207,400" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,3" fill="none" opacity="0.5"/>

  <!-- STAR_INDEX (N-mask) -->
  <circle cx="200" cy="400" r="7" fill="#ffffff" stroke="#f97316" stroke-width="3"/>
  <text x="68" y="398" font-size="11" font-weight="600" fill="#9a3412" text-anchor="end">STAR_INDEX</text>
  <text x="68" y="412" font-size="9" fill="#fdba74" text-anchor="end">(N-mask)</text>

  <!-- FASTQs to STAR_ALIGN N-mask (dashed blue left side) -->
  <path d="M193,278 C160,278 130,320 130,400 C130,440 160,468 193,470" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="4,3" fill="none" opacity="0.4"/>

  <!-- STAR_ALIGN (N-mask) -->
  <circle cx="200" cy="470" r="7" fill="#ffffff" stroke="#f97316" stroke-width="3"/>
  <text x="68" y="468" font-size="11" font-weight="600" fill="#9a3412" text-anchor="end">STAR_ALIGN</text>
  <text x="68" y="482" font-size="9" fill="#fdba74" text-anchor="end">(N-mask)</text>

  <!-- SORT_DEDUP (N-mask) -->
  <circle cx="200" cy="540" r="7" fill="#ffffff" stroke="#f97316" stroke-width="3"/>
  <text x="68" y="538" font-size="11" font-weight="600" fill="#9a3412" text-anchor="end">SORT_DEDUP</text>
  <text x="68" y="552" font-size="9" fill="#fdba74" text-anchor="end">samtools</text>

  <!-- SNPSPLIT (pink highlight) -->
  <circle cx="200" cy="630" r="9" fill="#ec4899" stroke="#be185d" stroke-width="2.5"/>
  <text x="68" y="626" font-size="12" font-weight="700" fill="#be185d" text-anchor="end">SNPSPLIT</text>
  <text x="68" y="640" font-size="9" fill="#f9a8d4" text-anchor="end">allele separation</text>

  <!-- SNP file to SNPSPLIT (dashed pink) -->
  <path d="M553,274 C560,420 400,520 270,590 C240,608 215,622 209,628" stroke="#ec4899" stroke-width="2" stroke-dasharray="5,3" fill="none" opacity="0.45"/>

  <!-- SNPSPLIT forks: genome1 (gold) + genome2 (indigo) -->
  <path d="M200,639 C200,660 150,680 150,700" stroke="#f59e0b" stroke-width="3.5" stroke-linecap="round" fill="none"/>
  <path d="M200,639 C200,660 280,680 280,700" stroke="#6366f1" stroke-width="3.5" stroke-linecap="round" fill="none"/>

  <!-- GREEN TRACK (Ref) x=460 -->
  <path d="M200,360 C260,360 460,370 460,400" stroke="#10b981" stroke-width="4" stroke-linecap="round" fill="none"/>
  <line x1="460" y1="400" x2="460" y2="760" stroke="#10b981" stroke-width="4" stroke-linecap="round"/>

  <!-- Ref FASTA to STAR Index Ref (dashed violet) -->
  <path d="M530,150 C530,240 490,350 467,395" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,3" fill="none" opacity="0.4"/>

  <!-- STAR_INDEX (Ref) -->
  <circle cx="460" cy="400" r="7" fill="#ffffff" stroke="#10b981" stroke-width="3"/>
  <text x="480" y="404" font-size="11" font-weight="600" fill="#065f46">STAR_INDEX</text>
  <text x="480" y="418" font-size="9" fill="#6ee7b7">(Reference)</text>

  <!-- FASTQs to STAR_ALIGN Ref (dashed blue) -->
  <path d="M207,278 C280,290 440,380 453,468" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="4,3" fill="none" opacity="0.35"/>

  <!-- STAR_ALIGN (Ref) -->
  <circle cx="460" cy="470" r="7" fill="#ffffff" stroke="#10b981" stroke-width="3"/>
  <text x="480" y="474" font-size="11" font-weight="600" fill="#065f46">STAR_ALIGN</text>
  <text x="480" y="488" font-size="9" fill="#6ee7b7">(Reference)</text>

  <!-- SORT_DEDUP (Ref) -->
  <circle cx="460" cy="540" r="7" fill="#ffffff" stroke="#10b981" stroke-width="3"/>
  <text x="480" y="544" font-size="11" font-weight="600" fill="#065f46">SORT_DEDUP</text>
  <text x="480" y="558" font-size="9" fill="#6ee7b7">samtools</text>

  <!-- GTF rail (dashed gray right side) -->
  <path d="M537,150 C620,150 640,200 640,280" stroke="#6b7280" stroke-width="1.5" stroke-dasharray="4,3" fill="none" opacity="0.35"/>
  <line x1="640" y1="280" x2="640" y2="730" stroke="#6b7280" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.25"/>
  <rect x="644" y="274" width="30" height="16" rx="8" fill="#f3f4f6"/>
  <text x="659" y="286" text-anchor="middle" font-size="8" font-weight="600" fill="#6b7280">GTF</text>

  <!-- GTF to STAR Indexes -->
  <path d="M640,400 L208,400" stroke="#6b7280" stroke-width="1" stroke-dasharray="3,3" fill="none" opacity="0.25"/>
  <path d="M640,400 L468,400" stroke="#6b7280" stroke-width="1" stroke-dasharray="3,3" fill="none" opacity="0.25"/>

  <!-- GTF to featureCounts -->
  <path d="M640,730 L470,730" stroke="#6b7280" stroke-width="1" stroke-dasharray="3,3" fill="none" opacity="0.25"/>
  <path d="M468,730 L290,730" stroke="#6b7280" stroke-width="1" stroke-dasharray="3,3" fill="none" opacity="0.2"/>
  <path d="M288,730 L160,730" stroke="#6b7280" stroke-width="1" stroke-dasharray="3,3" fill="none" opacity="0.18"/>

  <!-- FEATURECOUNTS genome1 (gold) -->
  <line x1="150" y1="700" x2="150" y2="760" stroke="#f59e0b" stroke-width="3.5" stroke-linecap="round"/>
  <circle cx="150" cy="730" r="7" fill="#ffffff" stroke="#f59e0b" stroke-width="3"/>
  <text x="28" y="726" font-size="10" font-weight="600" fill="#92400e" text-anchor="end">FEATURECOUNTS</text>
  <text x="28" y="740" font-size="9" fill="#fbbf24" text-anchor="end">genome1 (CAST_EiJ)</text>

  <!-- FEATURECOUNTS genome2 (indigo) -->
  <line x1="280" y1="700" x2="280" y2="760" stroke="#6366f1" stroke-width="3.5" stroke-linecap="round"/>
  <circle cx="280" cy="730" r="7" fill="#ffffff" stroke="#6366f1" stroke-width="3"/>
  <text x="300" y="726" font-size="10" font-weight="600" fill="#312e81">FEATURECOUNTS</text>
  <text x="300" y="740" font-size="9" fill="#818cf8">genome2 (C57BL_6NJ)</text>

  <!-- FEATURECOUNTS ref (green) -->
  <circle cx="460" cy="730" r="7" fill="#ffffff" stroke="#10b981" stroke-width="3"/>
  <text x="480" y="726" font-size="10" font-weight="600" fill="#065f46">FEATURECOUNTS</text>
  <text x="480" y="740" font-size="9" fill="#6ee7b7">reference (standard)</text>

  <!-- All to MultiQC -->
  <path d="M150,760 C150,790 330,800 330,820" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.5"/>
  <path d="M280,760 C280,790 330,800 330,820" stroke="#6366f1" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.5"/>
  <path d="M460,760 C460,790 330,800 330,820" stroke="#10b981" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.5"/>
  <line x1="330" y1="820" x2="330" y2="850" stroke="#14b8a6" stroke-width="4" stroke-linecap="round"/>
  <circle cx="330" cy="845" r="8" fill="#ffffff" stroke="#14b8a6" stroke-width="3"/>
  <text x="350" y="849" font-size="12" font-weight="700" fill="#0f766e">MULTIQC</text>

  <!-- LEGEND -->
  <rect x="540" y="830" width="240" height="80" rx="8" fill="#f9fafb" stroke="#e5e7eb" stroke-width="1"/>
  <text x="660" y="848" text-anchor="middle" font-size="10" font-weight="700" fill="#374151">LEGEND</text>
  <line x1="555" y1="862" x2="585" y2="862" stroke="#3b82f6" stroke-width="3" stroke-linecap="round"/>
  <text x="592" y="866" font-size="9" fill="#6b7280">Sample input</text>
  <line x1="555" y1="878" x2="585" y2="878" stroke="#f97316" stroke-width="3" stroke-linecap="round"/>
  <text x="592" y="882" font-size="9" fill="#6b7280">N-masked track</text>
  <line x1="555" y1="894" x2="585" y2="894" stroke="#10b981" stroke-width="3" stroke-linecap="round"/>
  <text x="592" y="898" font-size="9" fill="#6b7280">Reference track</text>
  <line x1="690" y1="862" x2="720" y2="862" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="727" y="866" font-size="9" fill="#6b7280">Refs</text>
  <line x1="690" y1="878" x2="720" y2="878" stroke="#ec4899" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="727" y="882" font-size="9" fill="#6b7280">SNP file</text>
  <line x1="690" y1="894" x2="720" y2="894" stroke="#6b7280" stroke-width="1.5" stroke-dasharray="4,3"/>
  <text x="727" y="898" font-size="9" fill="#6b7280">GTF</text>

  <text x="400" y="915" text-anchor="middle" font-size="9" fill="#d1d5db">github.com/IPNP-BIPN/SPLIT</text>
</svg>